<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Calcul MEMO LIF – SDIS 27</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      margin: 0;
      font-family: system-ui, Arial, sans-serif;
      background: #f5f7fa;
      color: #111;
      line-height: 1.6;
    }
    header {
      background: #0b1220;
      color: white;
      padding: 50px 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 2.2em;
    }
    header p {
      opacity: 0.9;
      font-size: 1.1em;
      margin: 10px 0 0 0;
    }
    section.page {
      max-width: 900px;
      margin: auto;
      padding: 30px 20px;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid #ddd;
    }
    .logo {
      max-height: 90px;
      width: auto;
      display: block;
      margin: 0 auto 15px auto;
    }
    .backlink {
      display: inline-block;
      margin-top: 14px;
      padding: 10px 14px;
      border-radius: 10px;
      background: rgba(255,255,255,0.12);
      color: white;
      text-decoration: none;
      font-weight: 700;
    }

    /* -------- Styles de l'outil LIF -------- */
    .lif-container{max-width:760px;margin:auto;padding:12px}
    .lif-card{background:#fff;border-radius:14px;padding:14px;margin-top:12px;border:1px solid #ddd}
    .lif-card-title{font-weight:900;margin-bottom:10px}
    .lif-grid{display:grid;grid-template-columns:1fr;gap:10px}
    .lif-field input,.lif-field select{width:100%;padding:10px;border-radius:10px;border:1px solid #ccc}
    .lif-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    .lif-btn{padding:12px;border-radius:12px;font-weight:700;cursor:pointer}
    .lif-btn-primary{background:#2563eb;color:#fff;border:0}
    .lif-btn-ghost{background:#fff;border:1px solid #ccc}
    .lif-badges{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    .lif-badge{background:#f5f5f5;padding:12px;border-radius:12px;text-align:center;font-weight:800}
    .lif-split{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .lif-panel{border:1px solid #ddd;border-radius:12px;padding:12px}
    .lif-panel-title{font-weight:900;margin-bottom:8px}
    .lif-panel-muted{background:#fafafa}
    .lif-row{display:flex;justify-content:space-between;padding:6px 0;font-weight:700;gap:10px}
    .lif-debord{margin-top:10px;padding:12px;border-radius:12px;text-align:center;font-weight:900;border:1px solid #ddd;background:#fff}
    .lif-help{display:block;margin-top:6px;font-size:12px;color:#5b5b5b}
    @media(max-width:640px){.lif-split{grid-template-columns:1fr}}
  </style>
</head>

<body>

<header>
  <img src="Logo.png" alt="Logo SDIS 27" class="Logo">
  <h1>Calcul LIF – Outil opérationnel – Feux de liquides inflammables</h1>
  <p>SDIS 27 – GGOC – Cne Florian PICO</p>
  <a class="backlink" href="index.html">← Retour à l’accueil</a>
</header>

<section class="page">
  <div class="card">

    <div class="lif-container">

      <!-- ================== SAISIE ================== -->
      <section class="lif-card">
        <div class="lif-card-title">1) Saisie</div>

        <div class="lif-grid">
          <div class="lif-field">
            <label>Surface en feu S (m²)</label>
            <input id="surfaceFeu" type="number" min="0" step="0.01" placeholder="Ex : 300">
          </div>

          <div class="lif-field">
            <label>Type de feu</label>
            <select id="typeFeu">
              <option value="nappe">Feu de nappe</option>
              <option value="bac">Feu de bac / cuvette</option>
            </select>
          </div>

          <div class="lif-field">
            <label>Mode d’attaque</label>
            <select id="attaque">
              <option value="indirect">Indirect</option>
              <option value="direct">Direct</option>
            </select>
          </div>

          <div class="lif-field">
            <label>Produit</label>
            <select id="produit">
              <option value="non_miscible">Non miscible</option>
              <option value="miscible">Miscible (alcool)</option>
            </select>
            <small class="lif-help">Concentration fixée à 3 %</small>
          </div>

          <!-- ✅ Champs à masquer quand "bac" est sélectionné -->
          <div class="lif-field" id="blocReflexe">
            <label>Bac : Réfléchi / Réflexe</label>
            <select id="reflexe">
              <option value="reflexe">Réflexe</option>
              <option value="reflechi">Réfléchi (POI)</option>
            </select>
          </div>

          <div class="lif-field" id="blocTexPoi">
            <label>Tex POI (L/min/m²)</label>
            <input id="texPoi" type="number" min="0" step="0.1" placeholder="Ex : 8">
            <small class="lif-help">Uniquement si Bac + Réfléchi</small>
          </div>

          <div class="lif-field">
            <label>Temporisation estimée (min)</label>
            <input id="tTempo" type="number" min="0" step="0.1" placeholder="Ex : 30">
          </div>

          <div class="lif-field" id="blocCuvette" style="display:none;">
            <label>Surface cuvette (m²)</label>
            <input id="surfaceCuvette" type="number" min="0" step="0.01" placeholder="Ex : 200">
          </div>
        </div>

        <div class="lif-actions">
          <button id="btnCalculer" class="lif-btn lif-btn-primary" type="button">Calculer</button>
          <button id="btnReset" class="lif-btn lif-btn-ghost" type="button">Réinitialiser</button>
        </div>
      </section>

      <!-- ================== RESULTATS ================== -->
      <section class="lif-card">
        <div class="lif-card-title">2) Résultats</div>

        <div class="lif-badges">
          <div class="lif-badge"><div>Tex</div><div id="oTex">—</div></div>
          <div class="lif-badge"><div>Durée ext.</div><div id="oT">—</div></div>
          <div class="lif-badge"><div>Concentration</div><div>3 %</div></div>
        </div>

        <div class="lif-split">
          <div class="lif-panel">
            <div class="lif-panel-title">EXTINCTION</div>
            <div class="lif-row"><span>Qext (L/min)</span><span id="oQext">—</span></div>
            <div class="lif-row"><span>V émulseur (L)</span><span id="oVemul">—</span></div>
            <div class="lif-row"><span>Entretien du tapis de mousse (L/min)</span><span id="oEntExt">—</span></div>
          </div>

          <div class="lif-panel">
            <div class="lif-panel-title">TEMPORISATION</div>
            <div class="lif-row"><span>Qtempo (L/min)</span><span id="oQtempo">—</span></div>
            <div class="lif-row"><span>V tempo (L)</span><span id="oVtempo">—</span></div>
          </div>
        </div>

        <!-- ================== RISQUE DE DEBORDEMENT (BAC UNIQUEMENT) ================== -->
        <div class="lif-panel lif-panel-muted" id="blocDebordement" style="display:none;margin-top:12px;">
          <div class="lif-panel-title">RISQUE DE DÉBORDEMENT</div>

          <div class="lif-grid">
            <div class="lif-field">
              <label>Volume présent (L)</label>
              <input id="vPresent" type="number" min="0">
            </div>
            <div class="lif-field">
              <label>Volume total bac (L)</label>
              <input id="vTotal" type="number" min="0">
            </div>
            <div class="lif-field">
              <label>Durée réelle temporisation (min)</label>
              <input id="tReel" type="number" min="0" step="0.1">
            </div>
          </div>

          <div class="lif-row"><span>Ajout temporisation (L)</span><span id="oAjTempo">—</span></div>
          <div class="lif-row"><span>Ajout extinction (40 min) (L)</span><span id="oAjExt">—</span></div>
          <div class="lif-row"><span>Marge avant débordement (L)</span><span id="oMarge">—</span></div>
          <div class="lif-row"><span>Temps avant débordement</span><span id="oTemps">—</span></div>

          <div class="lif-debord" id="oDebord">—</div>
        </div>

        <!-- ================== TAPIS PREVENTIF (SI DEBORDEMENT) ================== -->
        <div class="lif-panel lif-panel-muted" id="blocTapisPreventif" style="display:none;margin-top:12px;">
          <div class="lif-panel-title">TAPIS PRÉVENTIF</div>
          <div class="lif-row"><span>Volume émulseur (L)</span><span id="oVtapis">—</span></div>
          <div class="lif-row"><span>Débit entretien (L/min)</span><span id="oDentretien">—</span></div>
        </div>

      </section>

    </div>
  </div>
</section>

<script>
(() => {
  const $ = (id) => document.getElementById(id);

  const n = (v) => {
    if (v === null || v === undefined) return NaN;
    const s = String(v).replace(",", ".").trim();
    if (!s) return NaN;
    const x = Number(s);
    return Number.isFinite(x) ? x : NaN;
  };

  function setDebordUI(isDebord) {
    $("blocTapisPreventif").style.display = isDebord ? "block" : "none";
  }

  function updateUIForType() {
    const isBac = $("typeFeu").value === "bac";

    // visibilité surface cuvette
    $("blocCuvette").style.display = isBac ? "block" : "none";

    // visibilité débordement uniquement en bac/cuvette
    $("blocDebordement").style.display = isBac ? "block" : "none";

    // ✅ DEMANDE : masquer ces 2 champs quand "bac" est sélectionné
    $("blocReflexe").style.display = isBac ? "none" : "block";
    $("blocTexPoi").style.display  = isBac ? "none" : "block";

    // Valeurs par défaut / sécurité
    if (isBac) {
      // on force un état cohérent même si les champs sont masqués
      $("reflexe").value = "reflexe";
      $("texPoi").value = "";
      $("texPoi").disabled = true;
    } else {
      // en nappe, ces champs sont visibles mais non nécessaires : on les désactive
      $("texPoi").disabled = true;
      $("texPoi").value = "";
      $("reflexe").value = "reflexe";
    }

    // tapis préventif caché si pas débordement
    setDebordUI(false);

    // si nappe, vider surface cuvette (pour éviter confusions)
    if (!isBac) $("surfaceCuvette").value = "";
  }

  function compute() {
    const S = n($("surfaceFeu").value);
    if (!Number.isFinite(S) || S <= 0) return;

    const type = $("typeFeu").value;
    const atk = $("attaque").value;
    const prod = $("produit").value;
    const ref = $("reflexe").value;
    const texPoi = n($("texPoi").value);

    let Tex;

    /
