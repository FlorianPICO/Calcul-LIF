<!doctype html> 
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Calcul MEMO LIF ‚Äì SDIS 27</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    margin: 0;
    font-family: system-ui, Arial, sans-serif;
    background: #f5f7fa;
    color: #111;
    line-height: 1.6;
  }

  /* ‚úÖ HEADER RESPONSIVE (logo centr√© + texte adaptable) */
  header {
    background: #0b1220;
    color: white;
    padding: 42px 16px;
    text-align: center;

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 14px;
  }

  header h1 {
    margin: 0;
    font-size: clamp(1.3rem, 4.8vw, 2.2rem);
    line-height: 1.2;
    max-width: 28ch;
  }

  header p {
    opacity: 0.9;
    font-size: clamp(0.95rem, 3.2vw, 1.1rem);
    margin: 0;
    line-height: 1.25;
  }

  section.page {
    max-width: 900px;
    margin: auto;
    padding: 30px 20px;
  }

  .card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    border: 1px solid #ddd;
  }

  .lif-signature {
    margin-top: 18px;
    padding-top: 6px;
    font-size: 12px;
    color: #666;
    text-align: center;
  }

  /* ===== LOGO RESPONSIVE ===== */
  .logo {
    display: block;
    height: auto;
    width: min(150px, 45vw);
    max-height: 80px;
    object-fit: contain;
    margin: 0;
  }

  /* ===== AJUSTEMENTS MOBILE ===== */
  @media (max-width: 420px) {
    header {
      padding: 34px 14px;
    }
    header h1 {
      max-width: 20ch;
    }
    .logo {
      width: min(135px, 42vw);
    }
  }



  .hero-title {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    margin: 0;
    line-height: 1.2;
    text-align: center;
  }

.hero-title span {
  display: block;
  white-space: normal; /* ‚úÖ autorise l‚Äôadaptation √©cran */
}


  .backlink {
    display: inline-block;
    margin-top: 2px;
    padding: 10px 14px;
    border-radius: 10px;
    background: rgba(255,255,255,0.12);
    color: white;
    text-decoration: none;
    font-weight: 700;
  }

  .lif-field input,
  .lif-field select {
    box-sizing: border-box;
  }

  * {
    box-sizing: border-box;
  }

  /* -------- Styles de l'outil LIF -------- */
  .lif-container { max-width:760px; margin:auto; padding:12px }
  .lif-card { background:#fff; border-radius:14px; padding:14px; margin-top:12px; border:1px solid #ddd }

  .lif-card-title {
    font-size: 1.4rem;
    font-weight: 900;
    margin-bottom: 14px;
  }

  .lif-grid { display:grid; grid-template-columns:1fr; gap:10px }

  /* Grille 2 colonnes (heures d√©but / fin) */
  .lif-grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    align-items: start;
  }

  /* Mobile : on repasse en 1 colonne */
  @media (max-width: 520px) {
    .lif-grid-2 { grid-template-columns: 1fr; }
  }

  @media (max-width: 520px) {
    .lif-card { padding: 12px; }
    .lif-container { padding: 10px; }
    .lif-field input, .lif-field select { padding: 12px; } /* plus ‚Äútap friendly‚Äù */
  }

  .lif-field input, .lif-field select { width:100%; padding:10px; border-radius:10px; border:1px solid #ccc }
  .lif-actions { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px }
  .lif-btn { padding:12px; border-radius:12px; font-weight:700; cursor:pointer }
  .lif-btn-primary { background:#2563eb; color:#fff; border:0 }
  .lif-btn-ghost { background:#fff; border:1px solid #ccc }
  .lif-badges { display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px }
  .lif-badge { background:#f5f5f5; padding:12px; border-radius:12px; text-align:center; font-weight:800 }
  .lif-split { display:grid; grid-template-columns:1fr 1fr; gap:12px }
  .lif-panel { border:1px solid #ddd; border-radius:12px; padding:12px }
  .lif-panel-title { font-weight:900; margin-bottom:8px }
  .lif-panel-muted { background:#fafafa }
  .lif-row { display:flex; justify-content:space-between; padding:6px 0; font-weight:700; gap:10px }
  .lif-debord { margin-top:10px; padding:12px; border-radius:12px; text-align:center; font-weight:900; border:1px solid #ddd; background:#fff }
  .lif-help { display:block; margin-top:6px; font-size:12px; color:#5b5b5b }

  @media (max-width: 640px) {
    .lif-split { grid-template-columns: 1fr; }
    section.page { padding: 20px 14px; }
  }

  /* Petit bonus : encore plus propre sur tr√®s petits t√©l√©phones */
  @media (max-width: 420px) {
    header { padding: 34px 14px; }
    header h1 { max-width: 20ch; }
  }
</style>

</head>

<body>

<header>
  <img src="Logo.png" alt="Logo SDIS 27" class="Logo">

  <h1 class="hero-title">
    <span>Calcul LIF</span>
    <span>Outil op√©rationnel</span>
    <span>Feux de liquides inflammables</span>
  </h1>

  <p>SDIS 27 ‚Äì GGOC ‚Äì Capitaine Florian PICO</p>
  <a class="backlink" href="index.html">‚Üê Retour √† l‚Äôaccueil</a>
</header>

<section class="page">
  <div class="card">

    <div class="lif-container">

<!-- ================== PARAM√àTRES INTER-SDIS (AJOUT) ================== -->
<section class="lif-card">
  <div class="lif-card-title">0) Param√®tres</div>

  <div class="lif-grid">
    <div class="lif-field">
      <label>Mode :</label>
      <select id="modeSdis">
        <option value="lock" selected>SDIS 27 (verrouill√©)</option>
        <option value="custom">Autre SDIS (personnalisable)</option>
      </select>
      <small class="lif-help">
        Par d√©faut, les valeurs SDIS 27 sont appliqu√©es. En mode ‚ÄúAutre SDIS‚Äù, vous pouvez saisir votre doctrine.
      </small>
    </div>

    <!-- ‚úÖ Tout ce bloc est cach√© en SDIS27, visible en "Autre SDIS" -->
    <div id="customParams" style="display:none;">
      <div class="lif-grid">
        <div class="lif-field">
          <label>Concentration √©mulseur (%) :</label>
          <input id="concentrationPct" type="number" min="0" step="0.1" value="3" disabled>
          <small class="lif-help">D√©verrouill√© uniquement en mode ‚ÄúAutre SDIS‚Äù.</small>
        </div>

        <div class="lif-field">
          <label>Tex R√©flexe ‚Äì Indirect ‚Äì Non miscible (L/min/m¬≤) :</label>
          <input id="texIndNonMisc" type="number" min="0" step="0.1" value="5" disabled>
        </div>

        <div class="lif-field">
          <label>Tex R√©flexe ‚Äì Direct ‚Äì Non miscible (L/min/m¬≤) :</label>
          <input id="texDirNonMisc" type="number" min="0" step="0.1" value="10" disabled>
        </div>

        <div class="lif-field">
          <label>Tex R√©flexe ‚Äì Indirect ‚Äì Miscible (L/min/m¬≤) :</label>
          <input id="texIndMisc" type="number" min="0" step="0.1" value="10" disabled>
        </div>

        <div class="lif-field">
          <label>Tex R√©flexe ‚Äì Direct ‚Äì Miscible (L/min/m¬≤) :</label>
          <input id="texDirMisc" type="number" min="0" step="0.1" value="20" disabled>
        </div>
      </div>
    </div>
  </div>
</section>


      <!-- ================== SAISIE ================== -->
      <section class="lif-card">
        <div class="lif-card-title">1) Saisie</div>

        <div class="lif-grid">
          <div class="lif-field">
            <label>Surface en feu (m¬≤) :</label>
            <input id="surfaceFeu" type="number" min="0" step="0.01" placeholder="Ex : 300">
          </div>

          <div class="lif-field">
            <label>Type de feu :</label>
            <select id="typeFeu">
              <option value="nappe">Feu de nappe</option>
              <option value="bac">Feu de bac / cuvette</option>
            </select>
          </div>

          <div class="lif-field">
            <label>Mode d‚Äôattaque :</label>
            <select id="attaque">
              <option value="indirect">Indirect</option>
              <option value="direct">Direct</option>
            </select>
          </div>

          <div class="lif-field">
            <label>Produit :</label>
            <select id="produit">
              <option value="non_miscible">Non miscible</option>
              <option value="miscible">Miscible (alcool)</option>
            </select>
            <small class="lif-help">Concentration par d√©faut : 3 % (modifiable en mode ‚ÄúAutre SDIS‚Äù).</small>
          </div>

          <!-- POI : visible pour NAPPE + BAC -->
          <div class="lif-field" id="blocReflexe">
            <label>R√©flexe / R√©fl√©chi :</label>
            <select id="reflexe">
              <option value="reflexe">R√©flexe</option>
              <option value="reflechi">R√©fl√©chi (POI)</option>
            </select>
          </div>

          <!-- Tex POI : visible seulement si "R√©fl√©chi (POI)" -->
          <div class="lif-field" id="blocTexPoi" style="display:none;">
            <label>Taux d'extinction d√©fini dans POI (L/min/m¬≤) :</label>
            <input id="texPoi" type="number" min="0" step="0.1" placeholder="Ex : 8">
            <small class="lif-help">Visible uniquement si ‚ÄúR√©fl√©chi (POI)‚Äù</small>
          </div>

          <div class="lif-grid lif-grid-2">
            <div class="lif-field">
              <label>Heure de d√©but de temporisation :</label>
              <input id="tempoDebut" type="time">
            </div>

            <div class="lif-field">
              <label>Heure de fin de temporisation :</label>
              <input id="tempoFin" type="time">
            </div>
          </div>

          <!-- Cuvette : uniquement en bac -->
          <div class="lif-field" id="blocCuvette" style="display:none;">
            <label>Surface cuvette de r√©tention (m¬≤) :</label>
            <input id="surfaceCuvette" type="number" min="0" step="0.01" placeholder="Ex : 200">
          </div>
        </div>

        <div class="lif-actions">
          <button id="btnCalculer" class="lif-btn lif-btn-primary" type="button">Calculer</button>
          <button id="btnReset" class="lif-btn lif-btn-ghost" type="button">R√©initialiser</button>
        </div>
      </section>

      <!-- ================== RESULTATS ================== -->
      <section class="lif-card">
        <div class="lif-card-title">2) R√©sultats</div>

        <div class="lif-badges">
          <div class="lif-badge"><div>Tex</div><div id="oTex">‚Äî</div></div>
          <div class="lif-badge"><div>Dur√©e ext.</div><div id="oT">‚Äî</div></div>
          <div class="lif-badge"><div>Concentration</div><div id="oConc">3 %</div></div>
        </div>

        <div class="lif-split">
          <div class="lif-panel">
            <div class="lif-panel-title">EXTINCTION</div>
            <div class="lif-row"><span>Q ext (L/min) :</span><span id="oQext">‚Äî</span></div>
            <div class="lif-row"><span>V √©mulseur (L) :</span><span id="oVemul">‚Äî</span></div>
            <div class="lif-row">
              <span>V √©mulseur pour entretien du tapis de mousse (L) :</span>
              <span id="oEntExt">‚Äî</span>
            </div>
          </div>

          <div class="lif-panel">
            <div class="lif-panel-title">TEMPORISATION</div>
            <div class="lif-row"><span>Q tempo (L/min) :</span><span id="oQtempo">‚Äî</span></div>
            <div class="lif-row"><span>V tempo (L) :</span><span id="oVtempo">‚Äî</span></div>
          </div>
        </div>

        <!-- ================== RISQUE DE DEBORDEMENT (BAC UNIQUEMENT) ================== -->
        <div class="lif-panel lif-panel-muted" id="blocDebordement" style="display:none;margin-top:12px;">
          <div class="lif-panel-title">RISQUE DE D√âBORDEMENT</div>

          <div class="lif-grid">
            <div class="lif-field">
              <label>Volume d√©j√† pr√©sent dans le bac, avant notre arriv√©e (L) :</label>
              <input id="vPresent" type="number" min="0">
            </div>
            <div class="lif-field">
              <label>Capacit√©e totale du bac (L) :</label>
              <input id="vTotal" type="number" min="0">
            </div>
            <div class="lif-field">
              <label>Dur√©e r√©elle temporisation (min) :</label>
              <input id="tReel" type="number" min="0" step="0.1">
            </div>
          </div>

          <div class="lif-row"><span>Ajout temporisation (L)</span><span id="oAjTempo">‚Äî</span></div>
          <div class="lif-row"><span>Ajout extinction (40 min) (L)</span><span id="oAjExt">‚Äî</span></div>
          <div class="lif-row"><span>Marge avant d√©bordement (L)</span><span id="oMarge">‚Äî</span></div>
          <div class="lif-row"><span>Temps avant d√©bordement</span><span id="oTemps">‚Äî</span></div>

          <div class="lif-debord" id="oDebord">‚Äî</div>
        </div>

        <!-- ================== TAPIS PREVENTIF (SI DEBORDEMENT) ================== -->
        <div class="lif-panel lif-panel-muted" id="blocTapisPreventif" style="display:none;margin-top:12px;">
          <div class="lif-panel-title">TAPIS PR√âVENTIF</div>
          <div class="lif-row"><span>Volume √©mulseur (L)</span><span id="oVtapis">‚Äî</span></div>
          <div class="lif-row"><span>D√©bit entretien (L/min)</span><span id="oDentretien">‚Äî</span></div>
        </div>

      </section>

      <div class="lif-signature">
        ¬© Capitaine Florian PICO ‚Äì Outil MEMO LIF ‚Äì Usage professionnel
      </div>

    </div>
  </div>
</section>

<script>
(() => {
  const $ = (id) => document.getElementById(id);

  const n = (v) => {
    if (v === null || v === undefined) return NaN;
    const s = String(v).replace(",", ".").trim();
    if (!s) return NaN;
    const x = Number(s);
    return Number.isFinite(x) ? x : NaN;
  };

  function getTempoMinutes() {
    const d = $("tempoDebut").value;
    const f = $("tempoFin").value;
    if (!d || !f) return NaN;

    const [hd, md] = d.split(":").map(Number);
    const [hf, mf] = f.split(":").map(Number);

    let debut = hd * 60 + md;
    let fin = hf * 60 + mf;

    // Si passage minuit (ex : 23:50 ‚Üí 00:20)
    if (fin < debut) fin += 24 * 60;

    return fin - debut;
  }

  function setDebordUI(isDebord) {
    $("blocTapisPreventif").style.display = isDebord ? "block" : "none";
  }

  /* ================== PARAM√àTRES INTER-SDIS (AJOUT) ================== */
  function isCustomMode() {
    return $("modeSdis").value === "custom";
  }
function updateLockUI() {
  const custom = isCustomMode();

  // ‚úÖ Afficher/masquer le bloc complet des param√®tres
  $("customParams").style.display = custom ? "block" : "none";

  // champs custom √† d√©verrouiller
  const ids = [
    "concentrationPct",
    "texIndNonMisc", "texDirNonMisc",
    "texIndMisc", "texDirMisc",
  ];

  ids.forEach(id => { const el = $(id); if (el) el.disabled = !custom; });

  // S√©curit√© : en mode SDIS27, on force les valeurs doctrine
  if (!custom) {
    $("concentrationPct").value = 3;
    $("texIndNonMisc").value = 5;
    $("texDirNonMisc").value = 10;
    $("texIndMisc").value = 10;
    $("texDirMisc").value = 20;
  }

  compute();
}


  // ‚úÖ LOGIQUE DEMAND√âE :
  // - NAPPE : r√©flexe/r√©fl√©chi disponible
  // - BAC : r√©flexe/r√©fl√©chi disponible
  // - Tex POI visible + saisissable UNIQUEMENT si "r√©fl√©chi (POI)"
  function updateUI() {
    const isBac = $("typeFeu").value === "bac";
    const isReflechi = $("reflexe").value === "reflechi";

    // Bac : afficher cuvette + d√©bordement
    $("blocCuvette").style.display = isBac ? "block" : "none";
    $("blocDebordement").style.display = isBac ? "block" : "none";

    // Tex POI : visible/saisissable seulement si r√©fl√©chi
    $("blocTexPoi").style.display = isReflechi ? "block" : "none";
    $("texPoi").disabled = !isReflechi;

    // Si on repasse en r√©flexe : on vide Tex POI
    if (!isReflechi) $("texPoi").value = "";

    // Tapis pr√©ventif cach√© tant que pas de calcul d√©bordement
    setDebordUI(false);

    // Si nappe, vider surface cuvette pour √©viter confusion
    if (!isBac) $("surfaceCuvette").value = "";
  }

  function compute() {
    const S = n($("surfaceFeu").value);
    if (!Number.isFinite(S) || S <= 0) return;

    const type = $("typeFeu").value;       // nappe | bac
    const atk  = $("attaque").value;       // indirect | direct
    const prod = $("produit").value;       // non_miscible | miscible
    const ref  = $("reflexe").value;       // reflexe | reflechi
    const texPoi = n($("texPoi").value);

    // Param√®tres (toujours lisibles m√™me si disabled)
    const concPct = n($("concentrationPct").value);
    const conc = (Number.isFinite(concPct) && concPct >= 0) ? (concPct / 100) : 0.03;
    $("oConc").textContent = (Number.isFinite(concPct) ? `${concPct} %` : "3 %");

    const texIndNonMisc = n($("texIndNonMisc").value);
    const texDirNonMisc = n($("texDirNonMisc").value);
    const texIndMisc    = n($("texIndMisc").value);
    const texDirMisc    = n($("texDirMisc").value);

    /* ================== TEX ================== */
    let Tex;

    if (ref === "reflechi") {
      if (!Number.isFinite(texPoi) || texPoi <= 0) return;
      Tex = texPoi;
    } else {
      // R√©flexe : bar√®me (SDIS27 verrouill√© ou valeurs custom)
      const ind = (prod === "miscible") ? texIndMisc : texIndNonMisc;
      const dir = (prod === "miscible") ? texDirMisc : texDirNonMisc;
      Tex = (atk === "indirect") ? ind : dir;
    }

    if (!Number.isFinite(Tex) || Tex <= 0) return;

    /* ================== DUR√âES / D√âBITS ================== */
    const tExt = (type === "bac") ? 40 : (S < 400 ? 20 : 40);
    const Qext = S * Tex;
    const Qtempo = S * (Tex / 2);

    /* ================== AFFICHAGE DE BASE ================== */
    $("oTex").textContent    = Tex.toFixed(2);
    $("oT").textContent      = String(Math.round(tExt));
    $("oQext").textContent   = String(Math.round(Qext));
    $("oQtempo").textContent = String(Math.round(Qtempo));
    $("oEntExt").textContent = String(Math.round(S * 0.2));

    /* ================== V √âMULSEUR EXTINCTION (concentration param√©trable) ================== */
    const Vemul = Qext * tExt * conc;
    $("oVemul").textContent = String(Math.round(Vemul));

    /* ================== V TEMPO (LOGIQUE DEMAND√âE) ================== */
    const finRenseignee = !!$("tempoFin").value;
    const tTempoMin = getTempoMinutes(); // dur√©e r√©elle si d√©but + fin

    if (!finRenseignee) {
      // üîπ Nappe OU Bac + fin vide
      $("oVtempo").textContent = String(Math.round(Vemul / 2));
    } else {
      // üîπ Nappe OU Bac + fin remplie ‚Üí calcul r√©el
      $("oVtempo").textContent =
        Number.isFinite(tTempoMin)
          ? String(Math.round(Qtempo * tTempoMin * conc))
          : "‚Äî";
    }

    /* ================== D√âBORDEMENT (BAC UNIQUEMENT) ================== */
    if (type !== "bac") {
      setDebordUI(false);
      return;
    }

    const Vp = n($("vPresent").value);
    const Vt = n($("vTotal").value);
    const tr = n($("tReel").value);

    if (![Vp, Vt, tr].every(Number.isFinite) || Vt <= 0) {
      $("oAjTempo").textContent = "‚Äî";
      $("oAjExt").textContent   = "‚Äî";
      $("oMarge").textContent   = "‚Äî";
      $("oTemps").textContent   = "‚Äî";
      $("oDebord").textContent  = "‚Äî";
      setDebordUI(false);
      return;
    }

    const Vtempo = Qtempo * tr;
    const Vext   = Qext * 40;
    const marge  = Vt - (Vp + Vtempo + Vext);

    $("oAjTempo").textContent = String(Math.round(Vtempo));
    $("oAjExt").textContent   = String(Math.round(Vext));
    $("oMarge").textContent   = String(Math.round(marge));

    let deb = false;
    let msg = "Pas de d√©bordement";

    if (Vp >= Vt) {
      deb = true;
      msg = "D√©bordement imm√©diat (0 min)";
    } else {
      const margeInit = Vt - Vp;
      if (Qtempo * tr >= margeInit) {
        deb = true;
        msg = `D√©bordement pendant temporisation (~${(margeInit / Qtempo).toFixed(1)} min)`;
      } else {
        const reste = margeInit - Qtempo * tr;
        const tDebExt = reste / Qext;
        if (tDebExt <= 40) {
          deb = true;
          msg = `D√©bordement pendant extinction (~${(tr + tDebExt).toFixed(1)} min)`;
        }
      }
    }

    $("oTemps").textContent = msg;
    $("oDebord").textContent = deb ? "D√âBORDEMENT" : "PAS DE D√âBORDEMENT";
    $("oDebord").style.background  = deb ? "#fee2e2" : "#dcfce7";
    $("oDebord").style.borderColor = deb ? "#ef4444" : "#22c55e";
    $("oDebord").style.color       = deb ? "#7f1d1d" : "#065f46";

    setDebordUI(deb);

    if (deb) {
      const Sc = n($("surfaceCuvette").value);
      $("oVtapis").textContent = Number.isFinite(Sc) ? String(Math.round(Sc * 0.15 * 3)) : "‚Äî";
      $("oDentretien").textContent = Number.isFinite(Sc) ? String(Math.round(Sc * 0.2)) : "‚Äî";
    }
  }

  function resetAll() {
    $("surfaceFeu").value = "";
    $("typeFeu").value = "nappe";
    $("attaque").value = "indirect";
    $("produit").value = "non_miscible";
    $("reflexe").value = "reflexe";
    $("texPoi").value = "";
    $("tempoDebut").value = "";
    $("tempoFin").value = "";
    $("surfaceCuvette").value = "";

    $("vPresent").value = "";
    $("vTotal").value = "";
    $("tReel").value = "";

    // reset affichages
    ["oTex","oT","oQext","oVemul","oQtempo","oVtempo","oEntExt","oAjTempo","oAjExt","oMarge","oTemps","oDebord","oVtapis","oDentretien"]
      .forEach(id => { const e = $(id); if (e) e.textContent = "‚Äî"; });

    $("oConc").textContent = "3 %";

    $("oDebord").style.background = "#fff";
    $("oDebord").style.borderColor = "#ddd";
    $("oDebord").style.color = "#111";

    // reset mode + param√®tres (s√©curis√© SDIS27)
    $("modeSdis").value = "lock";
    updateLockUI();

    updateUI();
  }

  // handlers
  $("modeSdis").addEventListener("change", updateLockUI);

  $("typeFeu").addEventListener("change", () => { updateUI(); compute(); });
  $("reflexe").addEventListener("change", () => { updateUI(); compute(); });

  document.querySelectorAll("input,select").forEach(e => {
    e.addEventListener("input", compute);
    e.addEventListener("change", compute);
  });

  $("btnCalculer").addEventListener("click", compute);
  $("btnReset").addEventListener("click", resetAll);

  // init
  resetAll();
})();
</script>

</footer>
</body>
</html>










